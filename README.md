# Модуль 13: Диаграммы состояний и вариантов использования

Проект демонстрирует применение паттерна проектирования **State** и построение UML диаграмм для различных систем.

## 📚 Содержание

### Задание №1: Система бронирования номеров в гостинице
**Цель**: Реализация системы управления процессом бронирования номера в гостинице с использованием паттерна State.

#### Состояния системы:
1. **Idle** - Начальное состояние, система ожидает действия пользователя
2. **RoomSelected** - Пользователь выбрал номер, но не подтвердил бронирование
3. **BookingConfirmed** - Бронирование подтверждено, но не оплачено
4. **Paid** - Бронирование оплачено, номер закреплен за пользователем
5. **BookingCancelled** - Бронирование отменено

#### Функциональность:
- ✅ Выбор номера
- ✅ Подтверждение бронирования
- ✅ Оплата с проверкой суммы
- ✅ Отмена бронирования (на любом этапе до оплаты)
- ✅ Изменение номера до подтверждения
- ✅ Система скидок (5%, 10%, 15%, 20%)
- ✅ История всех операций

#### Диаграмма состояний:
```
┌─────────────┐
│             │
│    Idle     │ ◄─── Начальное состояние
│             │
└──────┬──────┘
       │ SelectRoom
       ▼
┌─────────────────┐
│  RoomSelected   │ ◄─── ChangeRoom (изменение номера)
└─────┬───────────┘
      │ ConfirmBooking
      ▼
┌─────────────────────┐
│ BookingConfirmed    │
└──────┬──────────────┘
       │ MakePayment
       ▼
┌──────────────┐
│     Paid     │ ◄─── Финальное состояние (успех)
└──────────────┘

       CancelBooking (в любой момент до оплаты)
       ▼
┌──────────────────────┐
│ BookingCancelled     │ ◄─── Финальное состояние (отмена)
└──────────────────────┘
```

---

### Задание №2: Система управления заявками на бронирование билетов
**Цель**: Реализация системы управления заявками с временными ограничениями на оплату.

#### Состояния заявки:
1. **Created** - Заявка только что создана
2. **WaitingForPayment** - Заявка отправлена клиенту для оплаты
3. **Paid** - Клиент завершил оплату
4. **Confirmed** - Система подтвердила успешное бронирование
5. **Cancelled** - Заявка была отменена (финальное состояние)

#### Правила переходов:
- Created → WaitingForPayment: после отправки клиенту
- WaitingForPayment → Paid: клиент произвел оплату
- WaitingForPayment → Cancelled: клиент не успел оплатить в срок
- Paid → Confirmed: после проверки бронирования

#### Функциональность:
- ✅ Создание заявки с указанием клиента и стоимости
- ✅ Отправка заявки клиенту с установкой срока оплаты (5 минут)
- ✅ Проверка срока оплаты
- ✅ Автоматическая отмена при истечении срока
- ✅ Обработка оплаты
- ✅ Подтверждение бронирования
- ✅ История операций

#### Диаграмма состояний:
```
┌─────────────┐
│   Created   │ ◄─── Начальное состояние
└──────┬──────┘
       │ SendToClient
       ▼
┌────────────────────┐
│ WaitingForPayment  │ ◄─── Установлен срок оплаты (5 мин)
└──────┬─────────────┘
       │ MakePayment (в срок)
       │
       ▼
┌──────────────┐
│     Paid     │
└──────┬───────┘
       │ ConfirmBooking
       ▼
┌──────────────────┐
│    Confirmed     │ ◄─── Финальное состояние (успех)
└──────────────────┘

    Срок истек / CancelRequest
           ▼
┌──────────────────┐
│    Cancelled     │ ◄─── Финальное состояние (отмена)
└──────────────────┘
```

---

### Задание №3: Система управления онлайн-курсами
**Цель**: Разработка системы с иерархией ролей пользователей и их взаимодействием.

#### Роли пользователей (иерархия наследования):

```
       User (базовый класс)
         │
         ├─── Student
         │      │
         │      └─── Teacher (может выполнять функции студента)
         │             │
         │             └─── Administrator (может выполнять функции преподавателя и студента)
```

#### Функциональность по ролям:

**Студент:**
- Регистрация и авторизация
- Просмотр доступных курсов
- Запись на курс
- Прохождение тестов и отслеживание прогресса
- Оставление отзывов на курсы

**Преподаватель** (наследует все от Студента + свои функции):
- Создание и редактирование курсов
- Добавление материалов курса
- Создание тестов для курсов
- Просмотр статистики успеваемости студентов
- Модерация отзывов

**Администратор** (наследует все от Преподавателя + свои функции):
- Управление учетными записями пользователей
- Управление категориями курсов
- Просмотр аналитики системы (число студентов, популярность курсов, успеваемость)

#### Диаграмма вариантов использования:

```
                    Система управления онлайн-курсами
                    
┌──────────┐                                           ┌──────────┐
│          │────── Регистрация и авторизация ──────────│          │
│          │                                           │          │
│          │────── Просмотр курсов ────────────────────│          │
│          │                                           │          │
│ Студент  │────── Запись на курс ─────────────────────│          │
│          │                                           │  Система │
│          │────── Прохождение тестов ─────────────────│          │
│          │                                           │          │
│          │────── Отслеживание прогресса ─────────────│          │
│          │                                           │          │
│          │────── Оставление отзывов ─────────────────│          │
└──────────┘                                           │          │
                                                       │          │
┌──────────────┐                                       │          │
│              │──── Создание курсов ──────────────────│          │
│              │                                       │          │
│              │──── Редактирование курсов ────────────│          │
│ Преподаватель│                                       │          │
│              │──── Добавление материалов ────────────│          │
│  (extends    │                                       │          │
│   Student)   │──── Создание тестов ──────────────────│          │
│              │                                       │          │
│              │──── Просмотр статистики ──────────────│          │
│              │                                       │          │
│              │──── Модерация отзывов ────────────────│          │
└──────────────┘                                       │          │
                                                       │          │
┌────────────────┐                                     │          │
│                │── Управление учетными записями ─────│          │
│                │                                     │          │
│ Администратор  │── Создание пользователей ───────────│          │
│                │                                     │          │
│   (extends     │── Удаление пользователей ───────────│          │
│   Teacher)     │                                     │          │
│                │── Блокировка пользователей ─────────│          │
│                │                                     │          │
│                │── Управление категориями ───────────│          │
│                │                                     │          │
│                │── Просмотр аналитики системы ───────│          │
└────────────────┘                                     └──────────┘
```

---

## 🚀 Запуск проекта

### Требования:
- .NET 9.0 или выше

### Компиляция:
```bash
dotnet build
```

### Запуск:
```bash
dotnet run
```

## 🎯 Использованные паттерны проектирования

### 1. State (Состояние)
Используется в Задании №1 и №2 для управления переходами между состояниями:
- **Контекст**: `HotelBookingContext`, `BookingRequestContext`
- **Интерфейс состояния**: `IBookingState`, `IBookingRequestState`
- **Конкретные состояния**: `IdleState`, `RoomSelectedState`, `BookingConfirmedState`, `PaidState`, `BookingCancelledState` и т.д.

### 2. Наследование (Inheritance)
Используется в Задании №3 для создания иерархии пользователей:
- `User` → `Student` → `Teacher` → `Administrator`

## 📊 Особенности реализации

### Задание №1:
- Система скидок с различными типами (5%, 10%, 15%, 20%)
- Валидация суммы оплаты
- Возможность изменения номера только до подтверждения
- Полная история операций с временными метками

### Задание №2:
- Временное ограничение на оплату (5 минут)
- Автоматическая отмена заявки при истечении срока
- Уникальный ID для каждой заявки
- Отображение оставшегося времени до истечения срока оплаты

### Задание №3:
- Иерархия ролей с наследованием функциональности
- Тестовые аккаунты для демонстрации
- Система курсов с материалами и тестами
- Система отзывов с модерацией
- Аналитика и статистика

## 📝 Тестовые данные (Задание №3)

### Тестовые аккаунты:
1. **Администратор**: admin@example.com / admin123
2. **Преподаватель 1**: teacher1@example.com / teacher123
3. **Преподаватель 2**: teacher2@example.com / teacher123
4. **Студент 1**: student1@example.com / student123
5. **Студент 2**: student2@example.com / student123

### Предустановленные курсы:
- C# для начинающих
- Паттерны проектирования
- ASP.NET Core MVC

## 🎓 Учебные цели

Проект демонстрирует:
1. Применение паттерна **State** для управления состояниями объектов
2. Построение UML диаграмм состояний
3. Построение UML диаграмм вариантов использования
4. Применение принципов ООП (наследование, инкапсуляция, полиморфизм)
5. Разработку консольных приложений на C# с интерактивным меню
6. Работу с коллекциями и LINQ
7. Обработку пользовательского ввода и валидацию данных

---

**Автор**: Студент курса "Шаблоны проектирования приложений"  
**Дата**: 2025

